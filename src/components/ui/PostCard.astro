---
import Avatar from "./Avatar.astro";
import Badge from "./Badge.astro";
import type { Post } from "../../lib/hashnode";

interface Props {
  post: Post;
}

const { post } = Astro.props;

const formatDate = (dateString: string) => {
  return new Date(dateString).toLocaleDateString("es-ES", {
    day: "2-digit",
    month: "2-digit",
    year: "numeric",
  });
};
---

<a
  href={`/post/${post.slug}`}
  class="group relative bg-card hover:bg-card/80 border border-white/5 hover:border-white/10 transition-all duration-300 rounded-2xl overflow-hidden cursor-pointer flex flex-col h-full"
>
  <div class="relative h-49 overflow-hidden">
    {
      post.tags && post.tags.length > 0 ? (
        <Badge text={post.tags[0].name} class="absolute top-4 left-4 z-10" />
      ) : (
        <Badge text="General" class="absolute top-4 left-4 z-10" />
      )
    }
    <img
      src={post.coverImage.url}
      alt={post.title}
      class="w-full h-full object-cover transform group-hover:scale-105 duration-700 opacity-80 group-hover:opacity-100 transition-all"
    />
  </div>
  <div class="p-6 flex-1 flex flex-col">
    <h3 class="text-lg font-semibold leading-snug">{post.title}</h3>
    <p class="text-sm text-gray-500 line-clamp-3 leading-relaxed">
      {post.brief}
    </p>
    <div
      class="flex items-center justify-between pt-4 mt-4 text-xs text-gray-500 border-t border-white/5"
    >
      <div class="flex items-center gap-2">
        <Avatar
          size="xs"
          src={post.author.profilePicture}
          alt={post.author.name}
        />
        <span>{post.author.name}</span>
      </div>
      <div class="flex items-center gap-4">
        <span>{formatDate(post.publishedAt)}</span>
        <span>{post.readTimeInMinutes} min</span>
      </div>
    </div>
  </div>
</a>
